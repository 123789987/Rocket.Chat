<template name="apps">
	<section class="rc-directory rc-apps-marketplace">
		{{#header sectionName="Apps" hideHelp=true fixedHeight=true fullpage=true}}
			<button class="rc-button rc-button--small rc-button--primary rc-directory-plus" data-button="install">{{> icon icon="plus"}}</button>
		{{/header}}
		<div class="rc-table-content">
			{{>tabs tabs=tabsData}}
			{{#requiresPermission 'manage-apps'}}
				{{#if isLoading}}
					<div class="rc-apps-loading">
						{{> loading}}
					</div>
				{{else}}
					<div class="rc-input rc-input--small rc-directory-search">
						<label class="rc-input__label">
							<div class="rc-input__wrapper">
								{{> icon icon="magnifier" block="rc-input__icon" }}
								<input type="text" class="rc-input__element rc-input__element--small js-search" name="message-search" id="message-search" placeholder={{#if $eq searchType 'channels'}}{{_ "Search_Channels"}}{{/if}}{{#if $eq searchType 'users'}}{{_ "Search_Users"}}{{/if}} autocomplete="off">
							</div>
						</label>
					</div>

					<div class="rc-apps-apps-container">
						<div class="rc-apps-apps">
							{{#each apps}}
								<div class="rc-apps-app manage" data-name="{{latest.name}}">
									<div class="rc-apps-app-content">
										<div class="rc-apps-app-icon">
											{{#if latest.iconFileData}}
												<div class="rc-table-avatar" style="background-image:url(data:image/png;base64,{{latest.iconFileData}})"></div>
											{{else}}
												<div class="rc-table-avatar" style="background-image:url({{latest.iconFileContent}})"></div>
											{{/if}}
										</div>
										<div class="rc-apps-app-info">
											<div class="rc-apps-app-info-title">
												{{latest.name}}
											</div>
											{{#if latest.author.name}}
												<div class="rc-apps-app-info-subtitle">by {{latest.author.name}}</div>
											{{/if}}

											<!-- <p class="rc-table-title">
												{{#if latest.summary}}
													{{latest.summary}}
												{{else}}
													{{latest.description}}
												{{/if}}
											</p>
											{{#if latest.summary}}
												<p>
													{{latest.description}}
												</p>
											{{/if}} -->
										</div>
										<div class="rc-apps-app-action">
											{{#if $eq latest._installed true}}
												<button class="js-configure rc-button rc-button--secondary rc-button--small" data-app="{{appId}}">
													{{_ "Open"}}
												</button>
											{{/if}}
											{{#if renderDownloadButton latest}}
												<div class="rc-apps-app-action-install">
													{{> icon block="rc-icon--default-size rc-icon" icon="loading"}}
													<button class="js-install rc-button rc-button--primary rc-button--small" data-app="{{appId}}">
														{{_ "Free"}}
													</button>
												</div>
											{{/if}}
										</div>
									</div>
									<div class="rc-apps-app-categories">
										{{#each latest.categories}}
											<div class="rc-apps-app-category">{{.}}</div>
										{{/each}}
									</div>
								</div>
							{{/each}}
						</div>
					</div>
				{{/if}}
			{{/requiresPermission}}
		</div>
	</section>
</template>
